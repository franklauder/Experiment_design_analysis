<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Francis Lauder">
<meta name="dcterms.date" content="2025-05-10">

<title>Experimental Design Analysis</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="experiment_design_files/clipboard.min.js"></script>
<script src="experiment_design_files/quarto.js"></script>
<script src="experiment_design_files/popper.min.js"></script>
<script src="experiment_design_files/tippy.umd.min.js"></script>
<script src="experiment_design_files/anchor.min.js"></script>
<link href="experiment_design_files/tippy.css" rel="stylesheet">
<link href="experiment_design_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="experiment_design_files/bootstrap.min.js"></script>
<link href="experiment_design_files/bootstrap-icons.css" rel="stylesheet">
<link href="experiment_design_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  Introduction</a></li>
  <li><a href="#data-review" id="toc-data-review" class="nav-link" data-scroll-target="#data-review"><span class="toc-section-number">2</span>  Data Review</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="toc-section-number">3</span>  Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#co2-emissions" id="toc-co2-emissions" class="nav-link" data-scroll-target="#co2-emissions"><span class="toc-section-number">3.1</span>  CO2 Emissions</a>
  <ul class="collapse">
  <li><a href="#hypothesis-testing-review" id="toc-hypothesis-testing-review" class="nav-link" data-scroll-target="#hypothesis-testing-review"><span class="toc-section-number">3.1.1</span>  Hypothesis Testing Review</a></li>
  <li><a href="#sharpio-wilk-test-for-normality" id="toc-sharpio-wilk-test-for-normality" class="nav-link" data-scroll-target="#sharpio-wilk-test-for-normality"><span class="toc-section-number">3.1.2</span>  Sharpio-Wilk Test for Normality</a></li>
  </ul></li>
  <li><a href="#co2-emissions-by-fuel-source" id="toc-co2-emissions-by-fuel-source" class="nav-link" data-scroll-target="#co2-emissions-by-fuel-source"><span class="toc-section-number">3.2</span>  CO2 Emissions by Fuel Source</a>
  <ul class="collapse">
  <li><a href="#skew-and-multimodality" id="toc-skew-and-multimodality" class="nav-link" data-scroll-target="#skew-and-multimodality"><span class="toc-section-number">3.2.1</span>  Skew and multimodality</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#statistical-tests-for-effects" id="toc-statistical-tests-for-effects" class="nav-link" data-scroll-target="#statistical-tests-for-effects"><span class="toc-section-number">4</span>  Statistical Tests for effects</a></li>
  <li><a href="#post-hoc-analysis" id="toc-post-hoc-analysis" class="nav-link" data-scroll-target="#post-hoc-analysis"><span class="toc-section-number">5</span>  Post-hoc Analysis</a>
  <ul class="collapse">
  <li><a href="#mann-whitney" id="toc-mann-whitney" class="nav-link" data-scroll-target="#mann-whitney"><span class="toc-section-number">5.1</span>  Mann-Whitney</a>
  <ul class="collapse">
  <li><a href="#group-analysis" id="toc-group-analysis" class="nav-link" data-scroll-target="#group-analysis"><span class="toc-section-number">5.1.1</span>  Group Analysis</a></li>
  </ul></li>
  <li><a href="#brunner-munzel-test" id="toc-brunner-munzel-test" class="nav-link" data-scroll-target="#brunner-munzel-test"><span class="toc-section-number">5.2</span>  Brunner-Munzel Test</a></li>
  </ul></li>
  <li><a href="#post-hoc-modeling" id="toc-post-hoc-modeling" class="nav-link" data-scroll-target="#post-hoc-modeling"><span class="toc-section-number">6</span>  Post-Hoc Modeling</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="toc-section-number">7</span>  Summary</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Experimental Design Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Francis Lauder </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p><br></p>
<p>This data set is from Kaggle. <a href="https://www.kaggle.com/datasets/abdelazizsami/exploring-experimental-design-in-the-energy-field">Exploring Experimental Design in the Energy Field</a></p>
<p>The premise is for us to investigate the impact of various fuel 
sources on CO2 emissions across different geographical regions. We first
 must determine which type of experimental design was used for this 
study. One type of experimental design has been determined, our goal 
will be to assess which assigned fuel source contributes the most to CO2
 emissions and whether this varies depending on location.</p>
<p>The data is from four distinct geographical regions: North, South, 
East, and West. In each region, multiple fuel sources—Natural Gas, 
Biofuel, and Coal—are used to generate energy. The resulting CO2 
emissions are measured to evaluate the environmental impact of each fuel
 source. <br><br></p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.graphics.gofplots <span class="im">import</span> qqplot</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats.distributions <span class="im">import</span> norm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
<section id="data-review" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data Review</h1>
<p><br></p>
<p><br></p>
<p>We’ll first examine the energy design b structure</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>energy_design_b.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 80 entries, 0 to 79
Data columns (total 3 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   Geographical_Region  80 non-null     object 
 1   Fuel_Source          80 non-null     object 
 2   CO2_Emissions        80 non-null     float64
dtypes: float64(1), object(2)
memory usage: 2.0+ KB</code></pre>
</div>
</div>
<p><br></p>
<p>From the output we find the the dimensions are 80 rows and three columns.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>energy_design_b.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Geographical_Region  Fuel_Source  CO2_Emissions
0               North  Natural_Gas      11.490142
1               North  Natural_Gas       9.585207
2               North  Natural_Gas      11.943066
3               North  Natural_Gas      14.569090
4               North  Natural_Gas       9.297540</code></pre>
</div>
</div>
<p><br></p>
<p>Next, let’s check the count of the different regions and fuel sources.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>energy_design_b.Fuel_Source.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fuel_Source
Biofuel        40
Natural_Gas    20
Coal           20
Name: count, dtype: int64</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>energy_design_b.Geographical_Region.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Geographical_Region
North    20
South    20
East     20
West     20
Name: count, dtype: int64</code></pre>
</div>
</div>
<p><br></p>
<p>From our counts we find regions split into equal groups of 20. Fuel 
source has Biofuel at 40 observations and 20 observations each for 
Natural Gas and Coal.</p>
<p><br></p>
<p>Finally, we’ll group the observations by Geographical Region and Fuel Source.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>energy_design_b.groupby([<span class="st">'Geographical_Region'</span>, <span class="st">'Fuel_Source'</span>]).count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                 CO2_Emissions
Geographical_Region Fuel_Source               
East                Biofuel                 10
                    Coal                     5
                    Natural_Gas              5
North               Biofuel                 10
                    Coal                     5
                    Natural_Gas              5
South               Biofuel                 10
                    Coal                     5
                    Natural_Gas              5
West                Biofuel                 10
                    Coal                     5
                    Natural_Gas              5</code></pre>
</div>
</div>
<p><br></p>
<p>From the grouping we can clearly see that region has been split into 
four blocks. Fuel source type is equally applied among all four regions 
with Biofuel at 10, and Coal and Natural Gas at 5 each. Based on these 
splits, we conclude that the experimental design of this data set is a 
block design</p>
<p>Geographical Region is our block.</p>
<p>Fuel source is our treatment, as it is a change that is given to a group.</p>
<p>For this study, the outcome variable is CO2 emissions.</p>
<p>We are trying to measure the effect of the treatment on our output variable. <br><br></p>
</section>
<section id="exploratory-data-analysis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Exploratory Data Analysis</h1>
<p><br> <br></p>
<section id="co2-emissions" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="co2-emissions"><span class="header-section-number">3.1</span> CO2 Emissions<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#co2-emissions" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>We will use visualizations and statistics to understand whether the 
distribution of CO2 Emissions is normal. A normal distribution is 
reflected as a bell shape. The mean and median for a normal distribution
 are the same. The image below is an example of a normal distribution.</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://stats.libretexts.org/Bookshelves/Introductory_Statistics/Statistics%3A_Open_for_Everyone_%28Peter%29/05%3A_The_Normal_Curve_z-Scores_and_Probability/5.02%3A_The_Normal_Distribution_Curve"><img src="experiment_design_files/nomral%20distribution.png" class="img-fluid figure-img" alt="LibreTexts Statistics"></a></p>
<p></p><figcaption class="figure-caption">Normal Distribution</figcaption><p></p>
</figure>
</div>
<p><br> <br> <br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="experiment_design_files/disPlot_Co2.png" class="img-fluid figure-img" width="750"></p>
<p></p><figcaption class="figure-caption">Kernel Density Plot-CO2 Emissions</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><br></p>
<p>Our distribution plot resembles a bell shape though the skew to the 
right creates an asymmetric (irregular) shape. This is an indication of a
 non-normal distribution.</p>
<p><br></p>
<p>We’ll use a qq plot to confirm our observation of a non-normal distribution for CO2 Emissions.</p>
<p><br></p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="experiment_design_files/qq_plot.png" class="img-fluid" width="1000"></p>
</div>
</div>
<p><br></p>
<p>In a qq plot a normal distribution would show all points hugging the 
straight line. The further from a straight line the points get the 
further from a non-normal distribution we are. From our qq plot we find 
our points deviate from the straight line around the middle and at the 
ends. This is another indication of non-normality.</p>
<p><br></p>
<p>Since both the QQ and distribution plots show that the variable “CO2 
Emissions” is not normally distributed, we’ll check our visualizations 
with statistics.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mean<span class="op">=</span>energy_design_b.CO2_Emissions.mean()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>median<span class="op">=</span>energy_design_b.CO2_Emissions.median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Mean for CO2 Emissions is: 30.72 and median is 28.72</code></pre>
</div>
</div>
<p><br></p>
<p>The mean for CO2 emissions is slightly larger the median which 
explains the skew to the right we saw in from the distribution plot.</p>
<p><br></p>
<section id="hypothesis-testing-review" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="hypothesis-testing-review"><span class="header-section-number">3.1.1</span> Hypothesis Testing Review<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#hypothesis-testing-review" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>Before we start, we’ll review hypothesis testing which will be used 
for the Shapiro-Wilk test and all other statistical tests used in our 
design analysis. Those who do not require a review of hypothesis testing
 can go directly to the Shapiro-Wilk section.</p>
<p>The goal of hypothesis testing is to decide whether the data we have 
is sufficient to support a particular hypothesis. To draw a conclusion, 
we will need to distinguish between two hypotheses (cases) and determine
 which one is true.</p>
<p>First, we define the null hypothesis which corresponds to “no 
effect”, “no difference”, or “no relationship”. Put another way, the 
null hypothesis states that there isn’t anything interesting happening 
and the observed patterns are by chance. Next, we set the alternative 
hypotheses which corresponds to “there is an effect”, “there is a 
difference”, or “there is a relationship”. This can be thought of as the
 observed patterns are not by chance and there is something interesting 
happening.</p>
<p>When we run a statistical test, we can either reject or fail to 
reject the null hypothesis, depending on whether we find an effect. 
Finding an effect can be thought of as positive while not finding an 
effect is a negative, and our conclusion will either be correct or 
incorrect. If we are incorrect, we can have either a false positive or a
 false negative. A false positive occurs when a hypothesis test results 
in rejecting the null hypothesis when in fact it is true. This a type I 
error. This can be thought of as finding a difference where none exists 
(supporting the alternative hypothesis. A false negative or failing to 
find a difference that is there (Fail to reject the null hypothesis when
 it is false), is a type II error.</p>
<p>Once we have our null hypothesis we must determine when to reject it.
 We use the p-value which is the probability of observing a result (or 
more extreme) assuming the null hypothesis is true. That is, the 
observed difference is due to chance. Put another way, the p-value tells
 us how surprising our results are if there were really no effect or 
difference (null hypothesis is true). A high p-value means the results 
are not surprising and could easily happen by chance. A low p-value 
means the results are unlikely to happen by chance, which could suggest 
something real might be going on. We can use an analogy to describe the 
p-value. Earlier we described the null hypothesis as stating there isn’t
 anything interesting happening. If the p-value is low, we can say this 
is surprising under the assumption that nothing is happening, and we 
should question this assumption. On the other hand, if the p-value is 
high, we can say that there’s nothing unusual happening, probably just 
random variation.</p>
<p>We determine whether the p-value is low or high by using the 
significance level (alpha) as a cutoff point. This is chosen ahead of 
time to decide if a p-value is low enough to say the result is 
statistically significant. For our testing we’ll be using a significance
 level of .05 which means we’re willing to accept a 5% chance of being 
wrong if we reject the null hypothesis (Type 1 error). If the p-value is
 below alpha, we say the result is statistically significant and likely 
not just due to chance.</p>
<p><br></p>
</section>
<section id="sharpio-wilk-test-for-normality" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="sharpio-wilk-test-for-normality"><span class="header-section-number">3.1.2</span> Sharpio-Wilk Test for Normality<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#sharpio-wilk-test-for-normality" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p><br></p>
<p>We’ll use the Sharpio-Wilk Test for normality to check if the 
distribution of the CO2 variable departs significantly from a normal 
distribution. This tells us how closely a given sample fits the patterns
 expected from a normal distribution.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> shapiro</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Null Hypothesis: The distribution of CO2 Emissions is normally distributed</p>
<p>Alternative Hypothesis: The distribution of CO2 Emissions is not normally distributed.</p>
<p>Significance level (alpha): .05</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="op">=</span><span class="fl">0.05</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>stat,p<span class="op">=</span>shapiro(energy_design_b[<span class="st">'CO2_Emissions'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>p value for the Shapiro Test: 0.0156</code></pre>
</div>
</div>
<p>The p value is less than .05, thus we have enough evidence to reject 
the null hypothesis and conclude the distribution is not normally 
distributed.</p>
<p><br></p>
</section>
</section>
<section id="co2-emissions-by-fuel-source" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="co2-emissions-by-fuel-source"><span class="header-section-number">3.2</span> CO2 Emissions by Fuel Source<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#co2-emissions-by-fuel-source" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p><br></p>
<p>We’ll now visualize distributions with are data split by Fuel Source. <br></p>
<p><br></p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="experiment_design_files/displot_fuelSource.png" class="img-fluid figure-img" width="818"></p>
<p></p><figcaption class="figure-caption">Kernel Density Plot-CO2 Emissions by Fuel Source</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><br> <br></p>
<p>All three fuel sources have skews to the right with Natural Gas 
having a longer right tail than the other fuel sources. Natural Gas has a
 primary peak around 10-20 CO2 Emissions and a smaller second bump near 
40-50. Biofuel has a primary peak around 20-25 and a smaller, flatter 
bump around 45-50. These second bumps could suggest slight multimodal or
 a subgroup within higher emissions. Coal does not exhibit a pronounced 
second peak as the other two fuel sources though there appears to be 
small bump to the right of the primary peak.</p>
<p><br></p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="experiment_design_files/violin_fuelSource.png" class="img-fluid" width="700"></p>
</div>
</div>
<p><br></p>
<p>The violin plots confirm what we observed from the distribution 
plots. The tails to the right of the violin plots are equivalent to the 
right skewed tails we observed in our distribution plots with the the 
plots wider on the left but with a thin tail on the right. In addition, 
we observe for Natural Gas and Biofuel, the right tail is asymmetric 
(irregular), which could be representative of the second bumps we 
observed on the distribution plots. The right tail for Coal appears to 
slightly asymmetric which could be a second peak.</p>
<p><br></p>
<section id="skew-and-multimodality" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="skew-and-multimodality"><span class="header-section-number">3.2.1</span> Skew and multimodality<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#skew-and-multimodality" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p>Our visual observations of CO2 Emissions by fuel source indicated 
possible differences in skew and multiple peaks. We’ll confirm this by 
applying statistical methods to calculate magnitude of skew and 
multimodality (multipe peaks) strength.</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> skew</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> gaussian_kde</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.signal <span class="im">import</span> find_peaks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p>First, we’ll quantify skew direction and magnitude of the Fuel Source group.</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fuel_sources<span class="op">=</span>energy_design_b[<span class="st">'Fuel_Source'</span>].unique()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>skewness_results<span class="op">=</span>{}</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fuel <span class="kw">in</span> fuel_sources:</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  data<span class="op">=</span>energy_design_b[energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">==</span> fuel][<span class="st">'CO2_Emissions'</span>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  skewness_results[fuel] <span class="op">=</span> skew(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>**Skewness results for Fuel Source**
Natural Gas: 1.021
Biofuel: 0.559
Coal: 0.615</code></pre>
</div>
</div>
<p><br></p>
<p>Skew magnitude: Negative magnitude would indicate a left skew, and positive magnitude indicates right skew.</p>
<p>Skew Magnitude</p>
<ul>
<li><p>0 to 0.5: Slight skew</p></li>
<li><p>0.5 to 1: Moderate skew</p></li>
<li><p>Greater than 1: Strong skew</p></li>
</ul>
<p><br></p>
<p>The skewness results support our observations from the distribution 
and violin plots: Natural Gas’s skew rates as a strong skew, matching 
the longer right tail observed in the plots. Biofuel and Coal show 
moderate right skews, suggesting some outliers though not as extreme as 
Natural Gas.</p>
<p><br></p>
<p>Next we’ll check if there are multiple peaks using multimodality test.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_multimodality(data, smoothing<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Estimate number of modes using KDE and find_peaks."""</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    kde <span class="op">=</span> gaussian_kde(data, bw_method<span class="op">=</span>smoothing <span class="op">/</span> np.std(data, ddof<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    x_grid <span class="op">=</span> np.linspace(<span class="bu">min</span>(data), <span class="bu">max</span>(data), <span class="dv">1000</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    kde_values <span class="op">=</span> kde.evaluate(x_grid)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find peaks in KDE curve</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    peaks, _ <span class="op">=</span> find_peaks(kde_values)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    num_peaks <span class="op">=</span> <span class="bu">len</span>(peaks)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num_peaks, x_grid, kde_values, peaks  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>modality_results <span class="op">=</span> {}</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plot_data <span class="op">=</span> {}  <span class="co"># Store for visualization</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fuel <span class="kw">in</span> fuel_sources:</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> energy_design_b[energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">==</span> fuel][<span class="st">'CO2_Emissions'</span>]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    num_peaks, x_grid, kde_values, peaks <span class="op">=</span> test_multimodality(data)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    modality_results[fuel] <span class="op">=</span> num_peaks</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    plot_data[fuel] <span class="op">=</span> (x_grid, kde_values, peaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>NaturalGas_modal_results<span class="op">=</span>modality_results[<span class="st">'Natural_Gas'</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>Biofuel_modal_results<span class="op">=</span>modality_results[<span class="st">'Biofuel'</span>]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>Coal_modal_results<span class="op">=</span>modality_results[<span class="st">'Coal'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>**Multimodality results for Fuel Source**
Natural Gas: 6
Biofuel: 11
Coal: 7</code></pre>
</div>
</div>
<p><br></p>
<p>Biofuel has a high number of peaks (11) which points to strong 
multimodality. Natural Gas has 6 distinct peaks which suggest likely 
multimodality. Coal has 7 peaks pointing to likely multimodality. These 
results validate that the data is varied (heterogenous) within each fuel
 source. The modality results point to a larger difference between 
Natural Gas and Biofuel while Biofuel and Coal are much closer than what
 ww observed in the visualizations.</p>
<p><br></p>
<p>The plot below helps visualize the number of peaks for each Fuel Source.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot KDEs with peaks marked</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> {<span class="st">'Natural_Gas'</span>: <span class="st">'skyblue'</span>, <span class="st">'Biofuel'</span>: <span class="st">'orange'</span>, <span class="st">'Coal'</span>: <span class="st">'green'</span>}</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fuel <span class="kw">in</span> fuel_sources:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    x_grid, kde_values, peaks <span class="op">=</span> plot_data[fuel]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    plt.plot(x_grid, kde_values, label<span class="op">=</span>fuel, color<span class="op">=</span>colors[fuel])</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    plt.scatter(x_grid[peaks], kde_values[peaks], color<span class="op">=</span>colors[fuel], edgecolor<span class="op">=</span><span class="st">'k'</span>, zorder<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>fuel<span class="sc">}</span><span class="ss"> Peaks"</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'KDE Curves with Detected Peaks for CO2 Emissions'</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'CO2 Emissions'</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Density'</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="experiment_design_files/unnamed-chunk-40-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p><br></p>
<p>The skewness and modality results indicate shape variation which 
might mean non-normality and distribution differences of CO2 Emissions 
between fuel sources. We will revisit this in our post-hoc analysis.</p>
<p><br></p>
<p><br></p>
<p><br> <br></p>
</section>
</section>
</section>
<section id="statistical-tests-for-effects" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Statistical Tests for effects</h1>
<p><br></p>
<p>We are going to use statistical tests to consider possible effect of 
fuel (treatment) on CO2 Emissions (outcome) and how sure we are that 
this effect exists.</p>
<p>Our test for normality confirmed CO2 Emissions is not normally 
distributed thus we will use the non-parametric Krusskal-Wallis tests 
for our analysis. Non-parametric tests don’t assume a distribution 
relying on the median and ranked based comparisons. Parametric test on 
the other hand assumes a normal distribution and really on the mean and 
variance to compare groups. Kruskal-Wallis test for overall differences 
ignoring blocks.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span>  ttest_ind</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.sandbox.stats.multicomp <span class="im">import</span> multipletests</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kruskal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>k_stat, k_pval<span class="op">=</span>kruskal(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>energy_design_b[energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">==</span> <span class="st">"Natural_Gas"</span>][<span class="st">'CO2_Emissions'</span>],</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>energy_design_b[energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">==</span> <span class="st">"Biofuel"</span>][<span class="st">'CO2_Emissions'</span>],</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>energy_design_b[energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">==</span> <span class="st">"Coal"</span>][<span class="st">'CO2_Emissions'</span>]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p>Null Hypothesis: There is no difference in median CO2 Emissions between fuel source groups.</p>
<p>Alternative Hypothesis: There is Significant difference of median CO2 Emissions between at least two fuel source groups.</p>
<p>Alpha=0.05 <br></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Krusskal-Wallis test p-value: 0.0000</code></pre>
</div>
</div>
<p><br></p>
<p>The p-value of 0.00 is less than the significance level of .05, thus 
we can conclude there is a difference in medians of CO2 Emissions 
between at least two fuel source groups. We have enough evidence to 
reject the null hypothesis.</p>
<p><br> <br></p>
</section>
<section id="post-hoc-analysis" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Post-hoc Analysis</h1>
<p><br> <br></p>
<p>Now that we have found significant results that differences exist we 
now want to determine how big these differences are. In other words, we 
wish to quantify the magnitude of a difference. Effect size is how 
important variation between treatments is. Outcomes with treatment A are
 Y higher than outcomes with treatment B.</p>
<p><br></p>
<section id="mann-whitney" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="mann-whitney"><span class="header-section-number">5.1</span> Mann-Whitney<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#mann-whitney" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p><br> <br></p>
<p><strong>U Statistic</strong></p>
<p>The U statistic is used to determine how separated or intermixed the groups’ ranks are.</p>
<p>It compares two independent groups by ranking all the data from lowest to highest</p>
<p>It then measures how many times a score from one group is less than a
 score in the other group.&nbsp; The U value represents a count of how 
many times a score from one group exceeds a score from another group.</p>
<p>The statistical significance is determined using the <strong>smaller U value</strong>
 because it corresponds to the greatest departure from the null 
hypothesis (i.e., the largest observed difference between groups).</p>
<p><em>High U value</em> – The groups have similar ranks (small difference)</p>
<p><em>Low U value</em> – One group consistently has higher or lower values than the other.</p>
<p><strong>Effect Size (r)</strong></p>
<p>Effect size is how large the difference between groups is. It helps 
us provide practical meaning to our results by indicating how important 
the variation between groups (magnitude of difference).</p>
<ul>
<li><p><em>r &lt; 0.3</em> Small difference (may not be important practically)</p></li>
<li><p><em>r 0.3–0.5</em> Moderate difference (likely important)</p></li>
<li><p><em>r &gt; 0.5</em> Large difference (definitely important)</p></li>
</ul>
<p><strong>Z Score (z)</strong></p>
<p>Provides us with the direction of the effect.</p>
<p><em>Negative Z</em> – The first group tends to have lower values than the second group.</p>
<p><em>Positive Z</em> – The first group tends to have higher values than the second group.</p>
<p><strong>P-Values</strong></p>
<p>P-values Tell us whether the difference between groups is 
statistically significant.&nbsp; When performing many tests 
simultaneously there is a risk of falsely concluding that a significant 
result exists. To correct for this possibility adjusted p-values are 
used to control for errors.</p>
<p><u>Adjusted P-Values</u></p>
<p><em>Bonferroni Correction</em>-controls the family-wise error rate 
(FWER), which is the probability of making at least one false positive 
(Type I error) among all tests. It is a conservative method, meaning it 
is more likely to lead to false negatives (failing to find a significant
 result when one truly exists)</p>
<p><em>Holm-Bonferroni Correction</em>- Is a method for controlling the 
family-wise error rate (FWER) when performing multiple hypothesis tests.
 It’s a less conservative approach than the traditional Bonferroni 
correction, meaning it’s more likely to detect true positive effects 
while still maintaining control over false positives.</p>
<p><em>Benjamini-Hochberg Procedure</em>, - also known as the False 
Discovery Rate (FDR) procedure, is a statistical method used to control 
the expected proportion of false discoveries.&nbsp; when multiple tests 
are performed.&nbsp; The probability of obtaining at least one false 
positive result increases leading to an increased overall type I error 
rate.&nbsp; The Benjamini-Hochberg procedure addresses this issue by 
controlling the FDR, which is defined as the expected proportion of 
false positives among the rejected hypotheses.</p>
<p><br></p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> wilcoxon</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> combinations</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> mannwhitneyu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Group data</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> energy_design_b.groupby(<span class="st">'Fuel_Source'</span>)[<span class="st">'CO2_Emissions'</span>].<span class="bu">apply</span>(<span class="bu">list</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>treatments <span class="op">=</span> groups.index.tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Store results</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>comparisons <span class="op">=</span> []</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>raw_p <span class="op">=</span> []</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>u_stats <span class="op">=</span> []</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>effect_sizes <span class="op">=</span> []</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>z_scores <span class="op">=</span> []</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>directions <span class="op">=</span> []</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute pairwise Mann-Whitney U tests</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t1, t2 <span class="kw">in</span> combinations(treatments, <span class="dv">2</span>):</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    g1 <span class="op">=</span> groups[t1]</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    g2 <span class="op">=</span> groups[t2]</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    n1, n2 <span class="op">=</span> <span class="bu">len</span>(g1), <span class="bu">len</span>(g2)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    U1, p <span class="op">=</span> mannwhitneyu(g1, g2,  alternative<span class="op">=</span><span class="st">'two-sided'</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    U2<span class="op">=</span>n1 <span class="op">*</span> n2 <span class="op">-</span>U1</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute effect size (rank-biserial correlation)</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> <span class="bu">min</span>(U1,U2)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    mu_u <span class="op">=</span> n1 <span class="op">*</span> n2 <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    sigma_u <span class="op">=</span> np.sqrt(n1 <span class="op">*</span> n2 <span class="op">*</span> (n1 <span class="op">+</span> n2 <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">12</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> (u <span class="op">-</span> mu_u) <span class="op">/</span> sigma_u</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="bu">abs</span>(z) <span class="op">/</span> np.sqrt(n1 <span class="op">+</span> n2)  <span class="co"># rank-biserial correlation</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine direction from Z-score</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> z <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>        direction <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>t1<span class="sc">}</span><span class="ss"> &gt; </span><span class="sc">{</span>t2<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> z <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>        direction <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>t1<span class="sc">}</span><span class="ss"> &lt; </span><span class="sc">{</span>t2<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>        direction <span class="op">=</span> <span class="st">"No difference"</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    comparisons.append(<span class="ss">f"</span><span class="sc">{</span>t1<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>t2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    raw_p.append(p)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    u_stats.append(u)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    effect_sizes.append(<span class="bu">round</span>(r, <span class="dv">4</span>))</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    z_scores.append(<span class="bu">round</span>(z, <span class="dv">4</span>))</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    directions.append(direction)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply corrections</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> [<span class="st">'bonferroni'</span>, <span class="st">'holm'</span>, <span class="st">'fdr_bh'</span>]</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>adjusted_pvals <span class="op">=</span> {method: multipletests(raw_p, method<span class="op">=</span>method)[<span class="dv">1</span>] <span class="cf">for</span> method <span class="kw">in</span> methods}</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Build result table</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Comparison'</span>: comparisons,</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mann-Whitney U'</span>: u_stats,</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Z-Score'</span>: z_scores,</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Effect Size (r)'</span>: effect_sizes,</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Effect Direction'</span>: directions,</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Raw p'</span>: raw_p,</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Bonferroni p'</span>: adjusted_pvals[<span class="st">'bonferroni'</span>],</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Holm p'</span>: adjusted_pvals[<span class="st">'holm'</span>],</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FDR (BH) p'</span>: adjusted_pvals[<span class="st">'fdr_bh'</span>]</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">4</span>).sort_values(<span class="st">'Raw p'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-overflow-wrap code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>results_table<span class="ot">=</span>results <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">where</span>(is.numeric), <span class="at">decimals =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Post-Hoc Comparisons"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="st">"Mann-Whitney U with Multiple Adjustments"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Groups"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Comparison</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Test Statistics"</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Mann-Whitney U"</span>, <span class="st">"Z-Score"</span>,<span class="st">"Effect Size (r)"</span>, <span class="st">"Effect Direction"</span>),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"P-Values"</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Raw p"</span>,<span class="st">"Bonferroni p"</span>, <span class="st">"Holm p"</span>, <span class="st">"FDR (BH) p"</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="fu">cell_text</span>(<span class="at">size=</span><span class="fu">px</span>(<span class="dv">12</span>)),</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">c</span>(<span class="st">"Comparison"</span>,<span class="st">"Mann-Whitney U"</span>,<span class="st">"Z-Score"</span>,<span class="st">"Effect Size (r)"</span>,<span class="st">"Effect Direction"</span>,<span class="st">"Raw p"</span>,<span class="st">"Bonferroni p"</span>, <span class="st">"Holm p"</span>, <span class="st">"FDR (BH) p"</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">%&gt;%</span> </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tab_style</span>(</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span><span class="fu">cell_text</span>(<span class="at">size=</span><span class="fu">px</span>(<span class="fl">10.5</span>)),</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="fu">c</span>(<span class="st">"Mann-Whitney U"</span>,<span class="st">"Z-Score"</span>,<span class="st">"Effect Size (r)"</span>,<span class="st">"Raw p"</span>,<span class="st">"Bonferroni p"</span>, <span class="st">"Holm p"</span>, <span class="st">"FDR (BH) p"</span>))</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">size=</span><span class="fu">px</span>(<span class="dv">11</span>)),</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations=</span><span class="fu">cells_body</span>(<span class="st">"Comparison"</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">size=</span><span class="fu">px</span>(<span class="dv">9</span>)),</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations=</span><span class="fu">cells_body</span>(<span class="st">"Effect Direction"</span>)</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Mann-Whitney U"</span>),</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Z-Score"</span>),</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Effect Size (r)"</span>),</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">vars</span>(<span class="st">"Raw p"</span>, <span class="st">"Bonferroni p"</span>, <span class="st">"Holm p"</span>, <span class="st">"FDR (BH) p"</span>),</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">4</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Center-align all columns</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Raw p"</span>,<span class="st">"Bonferroni p"</span>, <span class="st">"Holm p"</span>, <span class="st">"FDR (BH) p"</span>),</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>     <span class="at">method=</span><span class="st">"numeric"</span>,</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette=</span><span class="st">"YlGn"</span>,</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">domain=</span><span class="fu">c</span>(<span class="fl">0.0001</span>,<span class="fl">0.033</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"U statistic represents the degree of rank separation between groups; smaller values indicate greater differences."</span>,</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">c</span>(<span class="st">"Mann-Whitney U"</span>))</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Effect size (r) calculated as standardized Z divided by the square root of sample size; values of 0.1, 0.3, and 0.5 correspond to small, moderate, and large effects."</span>,</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">c</span>(<span class="st">"Effect Size (r)"</span>))</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Raw and adjusted p-values for multiple comparisons correction using Bonferroni, Holm, and Benjamini-Hochberg (FDR) procedures."</span>,</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">c</span>(<span class="st">"Raw p"</span>, <span class="st">"Bonferroni p"</span>, <span class="st">"Holm p"</span>, <span class="st">"FDR (BH) p"</span>))</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_caption</span>(<span class="st">"Post-Hoc Mann-Whitney U Test Results Comparing Fuel Sources: Effect Sizes and Adjusted P-Values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">

<div id="dgmqrqrcxr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dgmqrqrcxr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dgmqrqrcxr thead, #dgmqrqrcxr tbody, #dgmqrqrcxr tfoot, #dgmqrqrcxr tr, #dgmqrqrcxr td, #dgmqrqrcxr th {
  border-style: none;
}

#dgmqrqrcxr p {
  margin: 0;
  padding: 0;
}

#dgmqrqrcxr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dgmqrqrcxr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dgmqrqrcxr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dgmqrqrcxr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dgmqrqrcxr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dgmqrqrcxr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dgmqrqrcxr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dgmqrqrcxr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dgmqrqrcxr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dgmqrqrcxr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dgmqrqrcxr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dgmqrqrcxr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dgmqrqrcxr .gt_spanner_row {
  border-bottom-style: hidden;
}

#dgmqrqrcxr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dgmqrqrcxr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dgmqrqrcxr .gt_from_md > :first-child {
  margin-top: 0;
}

#dgmqrqrcxr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dgmqrqrcxr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dgmqrqrcxr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dgmqrqrcxr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dgmqrqrcxr .gt_row_group_first td {
  border-top-width: 2px;
}

#dgmqrqrcxr .gt_row_group_first th {
  border-top-width: 2px;
}

#dgmqrqrcxr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dgmqrqrcxr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dgmqrqrcxr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dgmqrqrcxr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dgmqrqrcxr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dgmqrqrcxr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dgmqrqrcxr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dgmqrqrcxr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dgmqrqrcxr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dgmqrqrcxr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dgmqrqrcxr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dgmqrqrcxr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dgmqrqrcxr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dgmqrqrcxr .gt_left {
  text-align: left;
}

#dgmqrqrcxr .gt_center {
  text-align: center;
}

#dgmqrqrcxr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dgmqrqrcxr .gt_font_normal {
  font-weight: normal;
}

#dgmqrqrcxr .gt_font_bold {
  font-weight: bold;
}

#dgmqrqrcxr .gt_font_italic {
  font-style: italic;
}

#dgmqrqrcxr .gt_super {
  font-size: 65%;
}

#dgmqrqrcxr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dgmqrqrcxr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dgmqrqrcxr .gt_indent_1 {
  text-indent: 5px;
}

#dgmqrqrcxr .gt_indent_2 {
  text-indent: 10px;
}

#dgmqrqrcxr .gt_indent_3 {
  text-indent: 15px;
}

#dgmqrqrcxr .gt_indent_4 {
  text-indent: 20px;
}

#dgmqrqrcxr .gt_indent_5 {
  text-indent: 25px;
}

#dgmqrqrcxr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dgmqrqrcxr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <caption>Post-Hoc Mann-Whitney U Test Results Comparing Fuel Sources: Effect Sizes and Adjusted P-Values</caption>
  <thead>
    <tr class="gt_heading">
      <td colspan="9" class="gt_heading gt_title gt_font_normal" style="">Post-Hoc Comparisons</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="9" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Mann-Whitney U with Multiple Adjustments</td>
    </tr>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="1" scope="col" id="Groups">
        <div class="gt_column_spanner">Groups</div>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="4" scope="colgroup" id="Test Statistics">
        <div class="gt_column_spanner">Test Statistics</div>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="4" scope="colgroup" id="P-Values">
        <div class="gt_column_spanner">P-Values</div>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="Comparison">Comparison</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="Mann-Whitney-U">Mann-Whitney U<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="Z-Score">Z-Score</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="Effect-Size-(r)">Effect Size (r)<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="Effect-Direction">Effect Direction</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="Raw-p">Raw p<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="Bonferroni-p">Bonferroni p<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="Holm-p">Holm p<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-size: 12px;" scope="col" id="FDR-(BH)-p">FDR (BH) p<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Comparison" class="gt_row gt_center" style="font-size: 11px;">Coal vs Natural_Gas</td>
<td headers="Mann-Whitney U" class="gt_row gt_center" style="font-size: 10.5px;">54</td>
<td headers="Z-Score" class="gt_row gt_center" style="font-size: 10.5px;">−3.949</td>
<td headers="Effect Size (r)" class="gt_row gt_center" style="font-size: 10.5px;">0.624</td>
<td headers="Effect Direction" class="gt_row gt_center" style="font-size: 9px;">Coal &lt; Natural_Gas</td>
<td headers="Raw p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #FFFFE5;">0.0001</td>
<td headers="Bonferroni p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #FFFFE4;">0.0002</td>
<td headers="Holm p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #FFFFE4;">0.0002</td>
<td headers="FDR (BH) p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #FFFFE4;">0.0002</td></tr>
    <tr><td headers="Comparison" class="gt_row gt_center" style="font-size: 11px;">Biofuel vs Natural_Gas</td>
<td headers="Mann-Whitney U" class="gt_row gt_center" style="font-size: 10.5px;">182</td>
<td headers="Z-Score" class="gt_row gt_center" style="font-size: 10.5px;">−3.418</td>
<td headers="Effect Size (r)" class="gt_row gt_center" style="font-size: 10.5px;">0.441</td>
<td headers="Effect Direction" class="gt_row gt_center" style="font-size: 9px;">Biofuel &lt; Natural_Gas</td>
<td headers="Raw p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #FEFFE0;">0.0006</td>
<td headers="Bonferroni p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #FCFED2;">0.0019</td>
<td headers="Holm p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #FDFED8;">0.0013</td>
<td headers="FDR (BH) p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #FDFEDB;">0.0010</td></tr>
    <tr><td headers="Comparison" class="gt_row gt_center" style="font-size: 11px;">Biofuel vs Coal</td>
<td headers="Mann-Whitney U" class="gt_row gt_center" style="font-size: 10.5px;">237</td>
<td headers="Z-Score" class="gt_row gt_center" style="font-size: 10.5px;">−2.556</td>
<td headers="Effect Size (r)" class="gt_row gt_center" style="font-size: 10.5px;">0.330</td>
<td headers="Effect Direction" class="gt_row gt_center" style="font-size: 9px;">Biofuel &lt; Coal</td>
<td headers="Raw p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #BFE596;">0.0108</td>
<td headers="Bonferroni p" class="gt_row gt_center" style="font-size: 10.5px; color: #FFFFFF; background-color: #00492B;">0.0325</td>
<td headers="Holm p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #BFE596;">0.0108</td>
<td headers="FDR (BH) p" class="gt_row gt_center" style="font-size: 10.5px; color: #000000; background-color: #BFE596;">0.0108</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> U statistic represents the degree of rank separation between groups; smaller values indicate greater differences.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span>
 Effect size (r) calculated as standardized Z divided by the square root
 of sample size; values of 0.1, 0.3, and 0.5 correspond to small, 
moderate, and large effects.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="9"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Raw and adjusted p-values for multiple comparisons correction using Bonferroni, Holm, and Benjamini-Hochberg (FDR) procedures.</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p><br></p>
<section id="group-analysis" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="group-analysis"><span class="header-section-number">5.1.1</span> Group Analysis<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#group-analysis" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h3>
<p><br></p>
<p><br></p>
<p>For all our group comparisons, the p-values are well below 0.05, so 
we reject the null hypothesis; there is a statistically significant 
difference in CO2 emissions between all our comparison groups.</p>
<p>Coal vs Natural Gas has a lower U, thus the <strong>there is clear separation</strong>
 in CO₂ emissions.&nbsp;&nbsp; Additionally, we conclude from the large 
effect size that the difference in emissions is very meaningful.&nbsp; 
Since the Z-score is negative, Natural Gas tends to have higher 
emissions than Coal in this dataset.</p>
<p>Biofuel vs Natural Gas has a larger U than Coal vs Natural and thus 
not as large of separation.&nbsp; Difference in CO2 emissions is 
moderate, important though not huge.&nbsp; Effect direction shows us 
that Natural Gas tends to have higher emissions than Biofuel in this 
dataset.</p>
<p>Biofuel vs Coal has a larger U than the two other group comparisons, 
meaning there is less separation compared to the to the other 
comparisons.&nbsp; Difference is moderate, slightly weaker than Biofuel 
vs Natural Gas.&nbsp;&nbsp; Effect direction shows us that Coal has 
higher emissions than Biofuel.</p>
<p><br></p>
<p><br></p>
</section>
</section>
<section id="brunner-munzel-test" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="brunner-munzel-test"><span class="header-section-number">5.2</span> Brunner-Munzel Test<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="#brunner-munzel-test" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p><br></p>
<p><br></p>
<p>We noted on both our visualization and statistical test of CO2 
Emissions distribution by fuel source that Natural Gas was heavily 
skewed compared to the other Fuel Sources. Though Mann-Whitney U is a 
non-parametric test and doesn’t assume normality, it does assume 
distributions are similarly shaped under the null.&nbsp; The test is 
primarily comparing medians, but when distributions have different 
shapes (skews and multimodality), it’s really comparing distributions 
overall, not just medians.&nbsp; Because of this, the test might 
overestimate differences due to distribution shape and not location 
(median) differences.</p>
<p>Brunner-Munzel is a non-parametric test that doesn’t assume equal variances or shapes.</p>
<p><strong>Test Interpretation:</strong></p>
<p>The test statistic is positive if the first group tends to have larger values than the second group.</p>
<p>The test statistic is negative if the first group tends to have smaller values than the second group.</p>
<p><br></p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> brunnermunzel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>biofuel <span class="op">=</span> energy_design_b[energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">==</span> <span class="st">'Biofuel'</span>][<span class="st">'CO2_Emissions'</span>]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>natural_gas <span class="op">=</span> energy_design_b[energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">==</span> <span class="st">'Natural_Gas'</span>][<span class="st">'CO2_Emissions'</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>coal <span class="op">=</span> energy_design_b[energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">==</span> <span class="st">'Coal'</span>][<span class="st">'CO2_Emissions'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We’ll run the Brunner-Munzel Test for each pairwise comparison</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>bm_results <span class="op">=</span> {}</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>bm_results[<span class="st">'Biofuel vs Coal'</span>] <span class="op">=</span> brunnermunzel(biofuel, coal)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>bm_results[<span class="st">'Biofuel vs Natural Gas'</span>] <span class="op">=</span> brunnermunzel(biofuel, natural_gas)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>bm_results[<span class="st">'Coal vs Natural Gas'</span>] <span class="op">=</span> brunnermunzel(coal, natural_gas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>bm_summary <span class="op">=</span> {</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    comparison: {</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Statistic"</span>: <span class="bu">round</span>(result.statistic, <span class="dv">4</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"p-Value"</span>: <span class="bu">round</span>(result.pvalue, <span class="dv">4</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> comparison, result <span class="kw">in</span> bm_results.items()</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Brunner-Munzel Test Results:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Brunner-Munzel Test Results:</code></pre>
</div>
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> comparison, result <span class="kw">in</span> bm_summary.items():</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>comparison<span class="sc">}</span><span class="ss">: Statistic = </span><span class="sc">{</span>result[<span class="st">'Statistic'</span>]<span class="sc">}</span><span class="ss">, p-Value = </span><span class="sc">{</span>result[<span class="st">'p-Value'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Biofuel vs Coal: Statistic = 3.0609, p-Value = 0.0034
Biofuel vs Natural Gas: Statistic = -3.6944, p-Value = 0.0011
Coal vs Natural Gas: Statistic = -6.0113, p-Value = 0.0</code></pre>
</div>
</div>
<p><br></p>
<p>The results from Brunner-Munzel show that even after accounting for 
differences in distribution shape and variance, all comparisons remain 
statistically significant.&nbsp; The detected differences are not just 
products of skewness and multimodality.&nbsp;</p>
<p>We do note that the test statistic for Biofuel vs Coal is positive 
which points to Biofuel having larger values than Coal.&nbsp; This does 
not correspond to the results from Mann Whitney which indicated Coal as 
having higher emissions than Biofuel.</p>
<p><br></p>
<p><br></p>
</section>
</section>
<section id="post-hoc-modeling" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Post-Hoc Modeling</h1>
<p><br></p>
<p><br></p>
<p>Based on authoritative sources, coal-fired electricity generation 
produces significantly more CO₂ emissions per unit of energy than both 
Natural Gas and Biofuel. Our Brunner-Munzel test results contradict 
established data.&nbsp; Possible cause for this contradiction may be 
regional differences of CO2 emissions or the use of fuel sources.</p>
<p>In addition to hypothesis testing, we fitted a generalized linear 
model to explore interactions between fuel source and region and predict
 emissions patterns.</p>
<p>Typically, modeling is not part of normal post hoc analysis.&nbsp; 
We’re not performing hypothesis testing, instead we will use our model 
to evaluate regional effects on CO2 emissions.</p>
<p>Generalized Linear Model (GLM) will be used for our modeling.&nbsp; 
CO2 emission will be the dependent (outcome) variable with Fuel Source 
and Region as predictors and show the interaction effect to see if the 
relationship between Fuel Source and CO2 emissions differs by region.</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Convert object types to categorical types</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>energy_design_b[<span class="st">'Fuel_Source'</span>] <span class="op">=</span> energy_design_b[<span class="st">'Fuel_Source'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>energy_design_b[<span class="st">'Geographical_Region'</span>] <span class="op">=</span> energy_design_b[<span class="st">'Geographical_Region'</span>].astype(<span class="st">'category'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Fit the GLM model with interaction using a Gamma distribution and log link (for right-skewed data)</p>
<div class="cell">
<details>
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>glm_model <span class="op">=</span> smf.glm(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    formula<span class="op">=</span><span class="st">'CO2_Emissions ~ Fuel_Source * Geographical_Region'</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>energy_design_b,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    family<span class="op">=</span>sm.families.Gamma(sm.families.links.log())</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>).fit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">

<table class="simpletable">
<caption>Generalized Linear Model Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>     <td>CO2_Emissions</td>  <th>  No. Observations:  </th>  <td>    80</td> 
</tr>
<tr>
  <th>Model:</th>                  <td>GLM</td>       <th>  Df Residuals:      </th>  <td>    68</td> 
</tr>
<tr>
  <th>Model Family:</th>          <td>Gamma</td>      <th>  Df Model:          </th>  <td>    11</td> 
</tr>
<tr>
  <th>Link Function:</th>          <td>log</td>       <th>  Scale:             </th> <td>0.028732</td>
</tr>
<tr>
  <th>Method:</th>                <td>IRLS</td>       <th>  Log-Likelihood:    </th> <td> -234.78</td>
</tr>
<tr>
  <th>Date:</th>            <td>Wed, 28 May 2025</td> <th>  Deviance:          </th> <td>  2.1742</td>
</tr>
<tr>
  <th>Time:</th>                <td>16:46:01</td>     <th>  Pearson chi2:      </th>  <td>  1.95</td> 
</tr>
<tr>
  <th>No. Iterations:</th>          <td>7</td>        <th>  Pseudo R-squ. (CS):</th>  <td>0.9987</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
                             <td></td>                                <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P&gt;|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                                               <td>    3.2086</td> <td>    0.054</td> <td>   59.860</td> <td> 0.000</td> <td>    3.104</td> <td>    3.314</td>
</tr>
<tr>
  <th>Fuel_Source[T.Coal]</th>                                     <td>    0.3713</td> <td>    0.093</td> <td>    4.000</td> <td> 0.000</td> <td>    0.189</td> <td>    0.553</td>
</tr>
<tr>
  <th>Fuel_Source[T.Natural_Gas]</th>                              <td>   -0.5546</td> <td>    0.093</td> <td>   -5.973</td> <td> 0.000</td> <td>   -0.737</td> <td>   -0.373</td>
</tr>
<tr>
  <th>Geographical_Region[T.North]</th>                            <td>   -0.2455</td> <td>    0.076</td> <td>   -3.239</td> <td> 0.001</td> <td>   -0.394</td> <td>   -0.097</td>
</tr>
<tr>
  <th>Geographical_Region[T.South]</th>                            <td>    0.6978</td> <td>    0.076</td> <td>    9.206</td> <td> 0.000</td> <td>    0.549</td> <td>    0.846</td>
</tr>
<tr>
  <th>Geographical_Region[T.West]</th>                             <td>    0.2473</td> <td>    0.076</td> <td>    3.262</td> <td> 0.001</td> <td>    0.099</td> <td>    0.396</td>
</tr>
<tr>
  <th>Fuel_Source[T.Coal]:Geographical_Region[T.North]</th>        <td>   -0.0076</td> <td>    0.131</td> <td>   -0.058</td> <td> 0.954</td> <td>   -0.265</td> <td>    0.250</td>
</tr>
<tr>
  <th>Fuel_Source[T.Natural_Gas]:Geographical_Region[T.North]</th> <td>    0.0230</td> <td>    0.131</td> <td>    0.175</td> <td> 0.861</td> <td>   -0.234</td> <td>    0.280</td>
</tr>
<tr>
  <th>Fuel_Source[T.Coal]:Geographical_Region[T.South]</th>        <td>   -0.2543</td> <td>    0.131</td> <td>   -1.937</td> <td> 0.053</td> <td>   -0.512</td> <td>    0.003</td>
</tr>
<tr>
  <th>Fuel_Source[T.Natural_Gas]:Geographical_Region[T.South]</th> <td>    0.3203</td> <td>    0.131</td> <td>    2.439</td> <td> 0.015</td> <td>    0.063</td> <td>    0.578</td>
</tr>
<tr>
  <th>Fuel_Source[T.Coal]:Geographical_Region[T.West]</th>         <td>   -0.1777</td> <td>    0.131</td> <td>   -1.354</td> <td> 0.176</td> <td>   -0.435</td> <td>    0.080</td>
</tr>
<tr>
  <th>Fuel_Source[T.Natural_Gas]:Geographical_Region[T.West]</th>  <td>   -0.0441</td> <td>    0.131</td> <td>   -0.336</td> <td> 0.737</td> <td>   -0.301</td> <td>    0.213</td>
</tr>
</tbody></table>
</div>
</div>
<p><br></p>
<p><strong>Output Table Interpretation:</strong></p>
<p>Biofuel and East Region are used for baseline CO2 emissions.&nbsp;</p>
<p>Fuel Source alone is a strong predictor of CO2 emissions.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Coal has significantly lower emissions than Biofuel (baseline)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Natural Gas has significantly lower emissions than Biofuel.</p>
<p>South and West regions show generally higher emissions.</p>
<p>Interaction effects (differences of CO2 emissions by fuel source and 
region) are mostly weak or not significant, except for Natural Gas in 
the South.</p>
<p><br></p>
</section>
<section id="summary" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Summary</h1>
<p><br> <br></p>
<p>From our results we conclude that CO2 emissions differ significantly 
between Fuel Source groups (Coal vs Natural Gas, Biofuel vs Natural Gas,
 Biofuel vs Coal). &nbsp;We do note that our comparison analysis 
returned unexpected results when it comes to which fuel source has 
higher CO2 emissions.</p>
<p>Possible causes for unexpected results:</p>
<ul>
<li><p>The dataset does not provide direct measure of energy output. Not
 knowing if per unit of energy produced is normalized, we are unsure of 
how much energy was produced and how efficiently was the fuel source was
 used.</p></li>
<li><p>Not all coal, biofuel, or natural gas sources are identical.</p></li>
<li><p>Different regions may use more modern, efficient power plants or outdated inefficient ones.</p></li>
<li><p>Regional regulations, maintenance standards, and operational practices can all influence how efficiently fuels are burned.</p></li>
<li><p>Are emissions measured at the source (point of combustion), or do
 they include life cycle emissions (production, transport, processing)?</p></li>
<li><p>Some regions may report only direct emissions; others include upstream and downstream effects.</p></li>
<li><p>Some plants have better emissions control systems, especially in regions with stricter regulations.</p></li>
</ul>
<p>Our additional analysis determined South and West regions show 
generally higher emissions in terms of regional/fuel source interaction 
effects on CO2 emissions only one interaction was found to significant 
(natural gas in the south region), thus we do not have evidence to 
suggest regional and fuel source interactions can explain our unexpected
 results.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<div class="modal__dialog micromodal-slide" id="quarto-log-error-modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="2" data-micromodal-close="">
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="quarto-log-error-modal-title">
      <header class="modal__header">
        <h2 class="modal__title" id="quarto-log-error-modal-title">
          <i class="bi bi-exclamation-circle"></i>Error
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close=""></button>
      </header>
      <div class="modal__content" id="quarto-log-error-modal-content">
        <pre tabindex="1" id="quarto-log-error-display"></pre>
      </div>
      <footer class="modal__footer">
      </footer>
    </div>
  </div>
</div>
<style type="text/css">
#quarto-log-error-modal .modal__overlay {
  z-index: 5000;
}
#quarto-log-error-modal-content {
  border: 1px solid #dee2e6;
  overflow-y: auto;
}
#quarto-log-error-display {
  min-height: 100px;
  padding: 8px;
  margin-bottom: 0;
  font-family: monospace;
}
#quarto-log-error-display:focus {
  outline: none;
}
.modal__dialog {
  font-size: 16px;
}
.modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal__container {
  position: fixed;
  top: 80px;
  background-color: #fff;
  padding: 15px;
  padding-top: 10px;
  min-width: 500px;
  max-width: 90%;
  max-height: 90vh;
  border-radius: 4px;
  overflow-y: auto;
  box-sizing: border-box;
}
.modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal__title {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 600;
  border-bottom: none;
  padding-bottom: 10px;
  font-size: 20px;
  color: rgb(191,71,65);
  line-height: 1.25;
  box-sizing: border-box;
}
.modal__title .bi {
  margin-right: 7px;
}
.modal__close {
  background: transparent;
  border: 0;
  margin-bottom: 10px;
}
.modal__header .modal__close:before { content: "\2715"; }
.modal__content {
  margin-top: 0;
  margin-bottom: 0;
}
@keyframes mmfadeIn {
    from { opacity: 0; }
      to { opacity: 1; }
}
@keyframes mmfadeOut {
    from { opacity: 1; }
      to { opacity: 0; }
}
@keyframes mmslideIn {
  from { transform: translateY(15%); }
    to { transform: translateY(0); }
}
@keyframes mmslideOut {
    from { transform: translateY(0); }
    to { transform: translateY(-10%); }
}
.micromodal-slide {
  display: none;
}
.micromodal-slide.is-open {
  display: block;
}
.micromodal-slide[aria-hidden="false"] .modal__overlay {
  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="false"] .modal__container {
  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__overlay {
  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__container {
  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide .modal__container,
.micromodal-slide .modal__overlay {
  will-change: transform;
} 
</style>
<script type="text/javascript">
  window.backupDefine = window.define; window.define = undefined;
  /*  ansi_up.js
   *  author : Dru Nelson
   *  license : MIT
   *  http://github.com/drudru/ansi_up
   */
   (function (root, factory) {
      if (typeof define === 'function' && define.amd) {
          // AMD. Register as an anonymous module.
          define(['exports'], factory);
      } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
          // CommonJS
          factory(exports);
      } else {
          // Browser globals
          var exp = {};
          factory(exp);
          root.AnsiUp = exp.default;
      }
  }(this, function (exports) {
  "use strict";
  var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
      if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
      return cooked;
  };
  var PacketKind;
  (function (PacketKind) {
      PacketKind[PacketKind["EOS"] = 0] = "EOS";
      PacketKind[PacketKind["Text"] = 1] = "Text";
      PacketKind[PacketKind["Incomplete"] = 2] = "Incomplete";
      PacketKind[PacketKind["ESC"] = 3] = "ESC";
      PacketKind[PacketKind["Unknown"] = 4] = "Unknown";
      PacketKind[PacketKind["SGR"] = 5] = "SGR";
      PacketKind[PacketKind["OSCURL"] = 6] = "OSCURL";
  })(PacketKind || (PacketKind = {}));
  var AnsiUp = (function () {
      function AnsiUp() {
          this.VERSION = "5.1.0";
          this.setup_palettes();
          this._use_classes = false;
          this.bold = false;
          this.italic = false;
          this.underline = false;
          this.fg = this.bg = null;
          this._buffer = '';
          this._url_whitelist = { 'http': 1, 'https': 1 };
      }
      Object.defineProperty(AnsiUp.prototype, "use_classes", {
          get: function () {
              return this._use_classes;
          },
          set: function (arg) {
              this._use_classes = arg;
          },
          enumerable: false,
          configurable: true
      });
      Object.defineProperty(AnsiUp.prototype, "url_whitelist", {
          get: function () {
              return this._url_whitelist;
          },
          set: function (arg) {
              this._url_whitelist = arg;
          },
          enumerable: false,
          configurable: true
      });
      AnsiUp.prototype.setup_palettes = function () {
          var _this = this;
          this.ansi_colors =
              [
                  [
                      { rgb: [0, 0, 0], class_name: "ansi-black" },
                      { rgb: [187, 0, 0], class_name: "ansi-red" },
                      { rgb: [0, 187, 0], class_name: "ansi-green" },
                      { rgb: [187, 187, 0], class_name: "ansi-yellow" },
                      { rgb: [0, 0, 187], class_name: "ansi-blue" },
                      { rgb: [187, 0, 187], class_name: "ansi-magenta" },
                      { rgb: [0, 187, 187], class_name: "ansi-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-white" }
                  ],
                  [
                      { rgb: [85, 85, 85], class_name: "ansi-bright-black" },
                      { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                      { rgb: [0, 255, 0], class_name: "ansi-bright-green" },
                      { rgb: [255, 255, 85], class_name: "ansi-bright-yellow" },
                      { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                      { rgb: [255, 85, 255], class_name: "ansi-bright-magenta" },
                      { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-bright-white" }
                  ]
              ];
          this.palette_256 = [];
          this.ansi_colors.forEach(function (palette) {
              palette.forEach(function (rec) {
                  _this.palette_256.push(rec);
              });
          });
          var levels = [0, 95, 135, 175, 215, 255];
          for (var r = 0; r < 6; ++r) {
              for (var g = 0; g < 6; ++g) {
                  for (var b = 0; b < 6; ++b) {
                      var col = { rgb: [levels[r], levels[g], levels[b]], class_name: 'truecolor' };
                      this.palette_256.push(col);
                  }
              }
          }
          var grey_level = 8;
          for (var i = 0; i < 24; ++i, grey_level += 10) {
              var gry = { rgb: [grey_level, grey_level, grey_level], class_name: 'truecolor' };
              this.palette_256.push(gry);
          }
      };
      AnsiUp.prototype.escape_txt_for_html = function (txt) {
          return txt.replace(/[&<>"']/gm, function (str) {
              if (str === "&")
                  return "&amp;";
              if (str === "<")
                  return "&lt;";
              if (str === ">")
                  return "&gt;";
              if (str === "\"")
                  return "&quot;";
              if (str === "'")
                  return "&#x27;";
          });
      };
      AnsiUp.prototype.append_buffer = function (txt) {
          var str = this._buffer + txt;
          this._buffer = str;
      };
      AnsiUp.prototype.get_next_packet = function () {
          var pkt = {
              kind: PacketKind.EOS,
              text: '',
              url: ''
          };
          var len = this._buffer.length;
          if (len == 0)
              return pkt;
          var pos = this._buffer.indexOf("\x1B");
          if (pos == -1) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer;
              this._buffer = '';
              return pkt;
          }
          if (pos > 0) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer.slice(0, pos);
              this._buffer = this._buffer.slice(pos);
              return pkt;
          }
          if (pos == 0) {
              if (len == 1) {
                  pkt.kind = PacketKind.Incomplete;
                  return pkt;
              }
              var next_char = this._buffer.charAt(1);
              if ((next_char != '[') && (next_char != ']')) {
                  pkt.kind = PacketKind.ESC;
                  pkt.text = this._buffer.slice(0, 1);
                  this._buffer = this._buffer.slice(1);
                  return pkt;
              }
              if (next_char == '[') {
                  if (!this._csi_regex) {
                      this._csi_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._csi_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if (match[4]) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if ((match[1] != '') || (match[3] != 'm'))
                      pkt.kind = PacketKind.Unknown;
                  else
                      pkt.kind = PacketKind.SGR;
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
              if (next_char == ']') {
                  if (len < 4) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if ((this._buffer.charAt(2) != '8')
                      || (this._buffer.charAt(3) != ';')) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if (!this._osc_st) {
                      this._osc_st = rgxG(__makeTemplateObject(["\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    "], ["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]));
                  }
                  this._osc_st.lastIndex = 0;
                  {
                      var match_1 = this._osc_st.exec(this._buffer);
                      if (match_1 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_1[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  {
                      var match_2 = this._osc_st.exec(this._buffer);
                      if (match_2 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_2[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  if (!this._osc_regex) {
                      this._osc_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._osc_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  pkt.kind = PacketKind.OSCURL;
                  pkt.url = match[1];
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
          }
      };
      AnsiUp.prototype.ansi_to_html = function (txt) {
          this.append_buffer(txt);
          var blocks = [];
          while (true) {
              var packet = this.get_next_packet();
              if ((packet.kind == PacketKind.EOS)
                  || (packet.kind == PacketKind.Incomplete))
                  break;
              if ((packet.kind == PacketKind.ESC)
                  || (packet.kind == PacketKind.Unknown))
                  continue;
              if (packet.kind == PacketKind.Text)
                  blocks.push(this.transform_to_html(this.with_state(packet)));
              else if (packet.kind == PacketKind.SGR)
                  this.process_ansi(packet);
              else if (packet.kind == PacketKind.OSCURL)
                  blocks.push(this.process_hyperlink(packet));
          }
          return blocks.join("");
      };
      AnsiUp.prototype.with_state = function (pkt) {
          return { bold: this.bold, italic: this.italic, underline: this.underline, fg: this.fg, bg: this.bg, text: pkt.text };
      };
      AnsiUp.prototype.process_ansi = function (pkt) {
          var sgr_cmds = pkt.text.split(';');
          while (sgr_cmds.length > 0) {
              var sgr_cmd_str = sgr_cmds.shift();
              var num = parseInt(sgr_cmd_str, 10);
              if (isNaN(num) || num === 0) {
                  this.fg = this.bg = null;
                  this.bold = false;
                  this.italic = false;
                  this.underline = false;
              }
              else if (num === 1) {
                  this.bold = true;
              }
              else if (num === 3) {
                  this.italic = true;
              }
              else if (num === 4) {
                  this.underline = true;
              }
              else if (num === 22) {
                  this.bold = false;
              }
              else if (num === 23) {
                  this.italic = false;
              }
              else if (num === 24) {
                  this.underline = false;
              }
              else if (num === 39) {
                  this.fg = null;
              }
              else if (num === 49) {
                  this.bg = null;
              }
              else if ((num >= 30) && (num < 38)) {
                  this.fg = this.ansi_colors[0][(num - 30)];
              }
              else if ((num >= 40) && (num < 48)) {
                  this.bg = this.ansi_colors[0][(num - 40)];
              }
              else if ((num >= 90) && (num < 98)) {
                  this.fg = this.ansi_colors[1][(num - 90)];
              }
              else if ((num >= 100) && (num < 108)) {
                  this.bg = this.ansi_colors[1][(num - 100)];
              }
              else if (num === 38 || num === 48) {
                  if (sgr_cmds.length > 0) {
                      var is_foreground = (num === 38);
                      var mode_cmd = sgr_cmds.shift();
                      if (mode_cmd === '5' && sgr_cmds.length > 0) {
                          var palette_index = parseInt(sgr_cmds.shift(), 10);
                          if (palette_index >= 0 && palette_index <= 255) {
                              if (is_foreground)
                                  this.fg = this.palette_256[palette_index];
                              else
                                  this.bg = this.palette_256[palette_index];
                          }
                      }
                      if (mode_cmd === '2' && sgr_cmds.length > 2) {
                          var r = parseInt(sgr_cmds.shift(), 10);
                          var g = parseInt(sgr_cmds.shift(), 10);
                          var b = parseInt(sgr_cmds.shift(), 10);
                          if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {
                              var c = { rgb: [r, g, b], class_name: 'truecolor' };
                              if (is_foreground)
                                  this.fg = c;
                              else
                                  this.bg = c;
                          }
                      }
                  }
              }
          }
      };
      AnsiUp.prototype.transform_to_html = function (fragment) {
          var txt = fragment.text;
          if (txt.length === 0)
              return txt;
          txt = this.escape_txt_for_html(txt);
          if (!fragment.bold && !fragment.italic && !fragment.underline && fragment.fg === null && fragment.bg === null)
              return txt;
          var styles = [];
          var classes = [];
          var fg = fragment.fg;
          var bg = fragment.bg;
          if (fragment.bold)
              styles.push('font-weight:bold');
          if (fragment.italic)
              styles.push('font-style:italic');
          if (fragment.underline)
              styles.push('text-decoration:underline');
          if (!this._use_classes) {
              if (fg)
                  styles.push("color:rgb(" + fg.rgb.join(',') + ")");
              if (bg)
                  styles.push("background-color:rgb(" + bg.rgb + ")");
          }
          else {
              if (fg) {
                  if (fg.class_name !== 'truecolor') {
                      classes.push(fg.class_name + "-fg");
                  }
                  else {
                      styles.push("color:rgb(" + fg.rgb.join(',') + ")");
                  }
              }
              if (bg) {
                  if (bg.class_name !== 'truecolor') {
                      classes.push(bg.class_name + "-bg");
                  }
                  else {
                      styles.push("background-color:rgb(" + bg.rgb.join(',') + ")");
                  }
              }
          }
          var class_string = '';
          var style_string = '';
          if (classes.length)
              class_string = " class=\"" + classes.join(' ') + "\"";
          if (styles.length)
              style_string = " style=\"" + styles.join(';') + "\"";
          return "<span" + style_string + class_string + ">" + txt + "</span>";
      };
      ;
      AnsiUp.prototype.process_hyperlink = function (pkt) {
          var parts = pkt.url.split(':');
          if (parts.length < 1)
              return '';
          if (!this._url_whitelist[parts[0]])
              return '';
          var result = "<a href=\"" + this.escape_txt_for_html(pkt.url) + "\">" + this.escape_txt_for_html(pkt.text) + "</a>";
          return result;
      };
      return AnsiUp;
  }());
  function rgx(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2);
  }
  function rgxG(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2, 'g');
  }
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.default = AnsiUp;
  }));
  // micromodal: https://github.com/Ghosh/micromodal
  !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MicroModal=t()}(this,(function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var n,i,a,r,s,l=(n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],i=function(){function o(e){var n=e.targetModal,i=e.triggers,a=void 0===i?[]:i,r=e.onShow,s=void 0===r?function(){}:r,l=e.onClose,c=void 0===l?function(){}:l,d=e.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=e.closeTrigger,h=void 0===f?"data-micromodal-close":f,v=e.openClass,g=void 0===v?"is-open":v,m=e.disableScroll,b=void 0!==m&&m,y=e.disableFocus,p=void 0!==y&&y,w=e.awaitCloseAnimation,E=void 0!==w&&w,k=e.awaitOpenAnimation,M=void 0!==k&&k,A=e.debugMode,C=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.modal=document.getElementById(n),this.config={debugMode:C,disableScroll:b,openTrigger:u,closeTrigger:h,openClass:g,onShow:s,onClose:c,awaitCloseAnimation:E,awaitOpenAnimation:M,disableFocus:p},a.length>0&&this.registerTriggers.apply(this,t(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var i,a,r;return i=o,(a=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];o.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var o=function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",o,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var o=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(o),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,t(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var o=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));o.length>0&&o[0].focus(),0===o.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&e(i.prototype,a),r&&e(i,r),o}(),a=null,r=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},s=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var o in t)r(o);return!0},{init:function(e){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=t(document.querySelectorAll("[".concat(o.openTrigger,"]"))),r=function(e,t){var o=[];return e.forEach((function(e){var n=e.attributes[t].value;void 0===o[n]&&(o[n]=[]),o[n].push(e)})),o}(n,o.openTrigger);if(!0!==o.debugMode||!1!==s(n,r))for(var l in r){var c=r[l];o.targetModal=l,o.triggers=t(c),a=new i(o)}},show:function(e,t){var o=t||{};o.targetModal=e,!0===o.debugMode&&!1===r(e)||(a&&a.removeEventListeners(),(a=new i(o)).showModal())},close:function(e){e?a.closeModalById(e):a.closeModal()}});return"undefined"!=typeof window&&(window.MicroModal=l),l}));  
  window.define = window.backupDefine; window.backupDefine = undefined;
  </script>
<script type="text/javascript">
  (function () {
    // forward keydown events so shortcuts can work in vscode, see:
    // https://github.com/microsoft/vscode/issues/65452#issuecomment-586485815
    if (window.parent.postMessage) {
      window.document.addEventListener('keydown', e => {
        const event = {
          type: "keydown",
          data: {
            altKey: e.altKey,
            code: e.code,
            ctrlKey: e.ctrlKey,
            isComposing: e.isComposing,
            key: e.key,
            location: e.location,
            metaKey: e.metaKey,
            repeat: e.repeat,
            shiftKey: e.shiftKey
          }
        };
        window.parent.postMessage(event, '*');
      });
    }
    // listen for execCommand messages
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-exec-command") {
        window.document.execCommand(event.data.data);
      } 
    }, true);
    const logEntries = new Array(1000);
    logEntries.offset = 0;
    function recordLogEntry(entry) {
      logEntries[logEntries.offset++] = entry;
      logEntries.offset %= logEntries.length;
    }
    function getLogEntry(i) { // backwards, 0 is most recent
        return logEntries[(logEntries.offset - 1 - i + logEntries.length) % logEntries.length];
    }
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    let path = window.location.pathname;
    if (!/\/$/.test(path)) path += "/";
    const devServerSocket = new WebSocket(protocol + "//" + window.location.host + path);
    let reloadPage = true;
    addEventListener("beforeunload", () => {
      // don't reload page in case of navigation events
      reloadPage = false;
    })
    devServerSocket.onopen = () => {
      console.log('Socket connection open. Listening for events.');
      // if the socket closes for any reason (e.g. this occurs in electron apps
      // when the computer suspends) then reload to reestablish the connection 
      devServerSocket.onclose = () => {
        if (reloadPage) {
          console.log('Socket connection closed. Reloading.');
          window.location.reload(true);
        }
      }
    };
    // append for errors that occur within the error window
    let lastError = 0;
    const kErrorWindow = 2500;
    function showError(msg) {
      const ansiUp = new AnsiUp
      const html = ansiUp.ansi_to_html(msg.trim());
      const display = document.getElementById("quarto-log-error-display");
      if (display.innerHTML && ((Date.now() - lastError) < kErrorWindow)) {
        display.innerHTML = display.innerHTML + "<br/>" +  html;
      } else {
        display.innerHTML = html
      }
      lastError = Date.now()
      MicroModal.show('quarto-log-error-modal', {
        awaitCloseAnimation: true,
        onClose: () => { display.innerHTML = ""; }
      });
      // post message to parent indicating we had an error
      if (window.parent.postMessage) {
        window.parent.postMessage({
          type: "error",
          msg: msg,
        }, "*");
      }
    }
    // see if there is already an error to show
    const renderError = document.getElementById("quarto-render-error");
    if (renderError) {
      showError(renderError.innerHTML.trim());
    }
    const normalizeTarget = (target) => {
      return target.replace(/\/index\.html/, "/")
    };
    devServerSocket.onmessage = (msg) => {
      if (msg.data.startsWith('reload')) {
        let target = normalizeTarget(msg.data.replace(/^reload/, ""));
        // prepend proxy path to target if we have one
        if (target) {
          const pathPrefix = 
            window.location.pathname.match(/^.*?\/p\/\w+\//) ||
            window.location.pathname.match(/^.*?\/user\/[\w\d]+\/proxy\/\d+\//);
          if (pathPrefix) {
            target = pathPrefix + target.slice(1);
          }
        }
        if (target && (target !== normalizeTarget(window.location.pathname))) {
          window.location.replace(target);
        } else {
          window.location.reload(true);
        }
      } else if (msg.data.startsWith('log:')) {
        const ansiUp = new AnsiUp
        const log = JSON.parse(msg.data.substr(4));
        recordLogEntry(log);
        if (log.levelName === "ERROR") {
          showError(log.msgFormatted)
        } else {
          // see if there is a knitr error to report
          const kExecutionHalted = "Execution halted";
          if (log.msg.indexOf(kExecutionHalted) !== -1) {
            // scan backwards for beginning of error
            const errorEntries = [getLogEntry(0).msgFormatted];
            for (let i=1; i<logEntries.length; i++) {
              const logEntry = getLogEntry(i);
              if (logEntry) {
                errorEntries.unshift(logEntry.msgFormatted);
                if (logEntry.msg.indexOf("Quitting from lines") !== -1) {
                  showError(errorEntries.join(""));
                  break;
                } else if (logEntry.msg.indexOf(kExecutionHalted) !== -1) {
                  break;
                }
              } else {
                break;
              }
            }
          }
        }
      }
    };
  })();
</script>

<script type="text/javascript">
  if (window.parent.postMessage) {
    // wait for message providing confirmation we are in a devhost
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-init") {
        window.quartoDevhost = {
          openInputFile: function (line, column, highlight) {
            window.parent.postMessage({
              type: "openfile",
              file: "/Users/francislauder/Documents/Data Sets/Energy Design/Experimental Design Analysis.qmd",
              line: line,
              column: column,
              highlight: highlight
            }, event.origin);
          }
        };
      } else if (event.data.type === "goback") {
        window.history.back()
      } else if (event.data.type === "goforward") {
        window.history.forward()
      }
    }, true);
    // notify host of navigation (e.g. for 'pop out' command)
    window.parent.postMessage({
      type: "navigate",
      href: window.location.href,
      file: "/Users/francislauder/Documents/Data Sets/Energy Design/Experimental Design Analysis.qmd"
    }, "*");
  }
</script>
</body></html>